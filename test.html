<html>

<head>
    <meta charset="utf-8">
    <title>D3 Test</title>
</head>
<link rel="stylesheet" type="text/css" href="./SmartTrafficChart.css" />

<body id="mybody">
    <button onclick="addData()">AddData</button>
    <script src="./lib/d3.js" charset="utf-8"></script>
    <script src="./SmartTrafficChart.js" charset="utf-8"></script>
    <script>
        function addData() {
            var _data = [],_d1=[];
            for (var i = 0; i < 20; ++i) {
                _data.push({
                    x: "2016-2-3 1:" + 5 * Math.floor(60 * Math.random()) % 60,
                    y: 100 + 100 * Math.random()+i
                });
                   _d1.push({
                    x: "2016-2-3 1:" + 5 * Math.floor(60 * Math.random()) % 60,
                    y: 100 + 100 * Math.random()+i
                });
            }
            var name = Math.floor(10 * Math.random());
            _c.addData({
                id: name,
                "name": "name" + name,
                "data": _data,
                option: {
                    type: "area",
                    y: "y",
                    ref: "y2",
                    yHint:"数量"
                }
            });
        _c.addData({
                id: name,
                "name": "name" + name,
                "data": _d1,
                option: {
                    type: "line",
                    y: "y",
                    ref: "y2",
                    yHint:"数量"
                }
            });
        };
        var _c = new SmartTrafficLineChart({
            "width": 1000,
            "height": 600,
            title: "D3测试",
            yTitle: "Y轴标题",
            xTitle: "x轴标题",
            secondTitle: "二级标题测试",
            y2Title: "y2轴标题"
        });
        var data = [{
            "y": "152",
            "x": "2016-2-3 1:00"
        }, {
            "y": "189",
            "x": "2016-2-3 1:05"
        }, {
            "y": "179",
            "x": "2016-2-3 1:10"
        }, {
            "y": "199",
            "x": "2016-2-3 1:20"
        }, {
            "y": "134",
            "x": "2016-2-3 1:30"
        }, {
            "y": "176",
            "x": "2016-2-3 1:40"
        }];
        _c.addData({
            "name": "bule",
            id: "no.1",
            "data": data,
            option: {
                type: "line"
            }
        });
        _c.appendTo("mybody");
        _c.addEventHandler("select", function(data) {
            console.log(data)
        });
        _c.addEventHandler("deSelect", function(data) {
            console.log("remove id = " + data.id)
        });

        // var ws = new WebSocket("ws://127.0.0.1:8123");
        // ws.onopen = function(){ws.send("Test!"); };

        // ws.onmessage = function(evt){
        //     console.log(evt.data);
        //     var data = JSON.parse(evt.data);
        //     _c.addFlowData("flow", {"x":data.time, "y": data.data},{"color":"blue"});
        //     };

        // ws.onclose = function(evt){console.log("WebSocketClosed!");};

        // ws.onerror = function(evt){console.log("WebSocketError!");};
    </script>
</body>

</html>